if("undefined"==typeof jQuery)throw new Error("multiselect requires jQuery");!function(e){"use strict";var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<7)throw new Error("multiselect requires jQuery version 1.7 or higher")}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){"use strict";var t=function(e){function t(t,l){var o=t.data(),i=[];console.log(o);for(var n in o)if(o.hasOwnProperty(n)){var r=n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()});i[r]*=o[n]}console.log(i),e.extend(l,o),console.log(l);var c=t.prop("id");this.id=c,this.$left=t,this.$right=e(e(l.right).length?l.right:"#"+c+"_to"),this.left=this.$left.get(0),this.right=this.$right.get(0),this.actions={$leftAll:e(e(l.leftAll).length?l.leftAll:"#"+c+"_leftAll"),$rightAll:e(e(l.rightAll).length?l.rightAll:"#"+c+"_rightAll"),$leftSelected:e(e(l.leftSelected).length?l.leftSelected:"#"+c+"_leftSelected"),$rightSelected:e(e(l.rightSelected).length?l.rightSelected:"#"+c+"_rightSelected")},delete l.leftAll,delete l.leftSelected,delete l.right,delete l.rightAll,delete l.rightSelected,this.options={keepRenderingSort:l.keepRenderingSort,submitAllLeft:void 0!==l.submitAllLeft?l.submitAllLeft:!0,submitAllRight:void 0!==l.submitAllRight?l.submitAllRight:!0,leftSearch:l.leftSearch,rightSearch:l.rightSearch,leftBulk:l.leftBulk},delete l.keepRenderingSort,l.submitAllLeft,l.submitAllRight,l.search,this.callbacks=l,this.init()}return t.prototype={init:function(){var t=this;t.options.keepRenderingSort&&(t.skipInitSort=!0,t.callbacks.sort=function(t,l){return e(t).data("position")>e(l).data("position")?1:-1},t.$left.find("option").each(function(t,l){e(l).data("position",t)}),t.$right.find("option").each(function(t,l){e(l).data("position",t)})),"function"==typeof t.callbacks.startUp&&t.callbacks.startUp(t.$left,t.$right),t.skipInitSort||"function"!=typeof t.callbacks.sort||t.$left.mSort(t.callbacks.sort),t.options.leftSearch?t.options.$leftSearch=e(t.options.leftSearch):e("#"+t.id+"_leftSearch").length>0&&(t.options.$leftSearch=e("#"+t.id+"_leftSearch")),t.options.rightSearch?t.options.$rightSearch=e(t.options.rightSearch):e("#"+t.id+"_rightSearch").length>0&&(t.options.$rightSearch=e("#"+t.id+"_rightSearch")),t.options.leftBulk?t.options.$leftBulk=e(t.options.leftBulk):e("#"+t.id+"_leftBulk").length>0&&(t.options.$leftBulk=e("#"+t.id+"_leftBulk")),t.events()},events:function(){var t=this;t.options.$leftSearch&&t.options.$leftSearch.on("keyup",function(e){t.$left.mfilter(this.value)}),t.options.$rightSearch&&t.options.$rightSearch.on("keyup",function(e){t.$right.mfilter(this.value)}),t.$right.closest("form").on("submit",function(l){t.$left.children().prop("selected",t.options.submitAllLeft),t.$right.children().prop("selected",!1);for(var o=t.right.querySelectorAll("option"),i=[],n=0;n<o.length;n++){var r=o[n].value;r.length>0&&i.push(r)}var c=e('<input type="hidden" name="'+t.$right.attr("name")+'">');c.val(i.join(",")),t.$right.before(c)}),t.$left.on("dblclick","option",function(e){e.preventDefault();var l=t.left.querySelectorAll("option:checked");l.length&&t.moveToRight(l,e)}),t.$right.on("dblclick","option",function(e){e.preventDefault();var l=t.right.querySelectorAll("option:checked");l.length&&t.moveToLeft(l,e)}),(navigator.userAgent.match(/MSIE/i)||navigator.userAgent.indexOf("Trident/")>0||navigator.userAgent.indexOf("Edge/")>0)&&(t.$left.dblclick(function(e){t.actions.$rightSelected.trigger("click")}),t.$right.dblclick(function(e){t.actions.$leftSelected.trigger("click")})),t.actions.$rightSelected.on("click",function(l){l.preventDefault();var o=null;if(t.options.$leftBulk&&t.options.$leftBulk.val().length>0){o=[];var i=t.options.$leftBulk.val(),n=i.split(/\n/).filter(function(e){return e.length>0?e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").toLowerCase():void 0});if(n.length>0)for(var r=t.left.querySelectorAll("option"),c=0;c<r.length;c++)for(var f=r[c].innerHTML.toLowerCase(),a=n.length-1;a>=0;a--)f.indexOf(n[a])>-1&&f.match(new RegExp("([^0-9]|^)"+n[a]+"([^0-9]|$)","g"))&&o.push(r[c]);t.options.$leftBulk.val("")}else o=t.left.querySelectorAll("option:checked");o&&o.length&&t.moveToRight(o,l),e(this).blur()}),t.actions.$leftSelected.on("click",function(l){l.preventDefault();var o=t.right.querySelectorAll("option:checked");o.length&&t.moveToLeft(o,l),e(this).blur()}),t.actions.$rightAll.on("click",function(l){l.preventDefault();var o=t.left.querySelectorAll("option");o.length&&t.moveToRight(o,l),e(this).blur()}),t.actions.$leftAll.on("click",function(l){l.preventDefault();var o=t.right.querySelectorAll("option");o.length&&t.moveToLeft(o,l),e(this).blur()})},moveToRight:function(e,t,l,o){var i=this;if("function"==typeof i.callbacks.moveToRight)return i.callbacks.moveToRight(i,e,t,l,o);if("function"==typeof i.callbacks.beforeMoveToRight&&!l&&!i.callbacks.beforeMoveToRight(i.$left,i.$right,e))return!1;i.options.$rightSearch&&0!==i.options.$rightSearch.val().length&&(i.options.$rightSearch.val(""),i.$right.mfilter(""));for(var n=document.createDocumentFragment(),r=0;r<e.length;r++)n.appendChild(e[r]);return i.right.appendChild(n.cloneNode(!0)),"function"!=typeof i.callbacks.sort||l||i.$right.mSort(i.callbacks.sort),"function"!=typeof i.callbacks.afterMoveToRight||l||i.callbacks.afterMoveToRight(i.$left,i.$right,e),i},moveToLeft:function(e,t,l,o){var i=this;if("function"==typeof i.callbacks.moveToLeft)return i.callbacks.moveToLeft(i,e,t,l,o);if("function"==typeof i.callbacks.beforeMoveToLeft&&!l&&!i.callbacks.beforeMoveToLeft(i.$left,i.$right,e))return!1;i.options.$leftSearch&&0!==i.options.$leftSearch.val().length&&(i.options.$leftSearch.val(""),i.$left.mfilter(""));for(var n=document.createDocumentFragment(),r=0;r<e.length;r++)n.appendChild(e[r]);return i.left.appendChild(n.cloneNode(!0)),"function"!=typeof i.callbacks.sort||l||i.$left.mSort(i.callbacks.sort),"function"!=typeof i.callbacks.afterMoveToLeft||l||i.callbacks.afterMoveToLeft(i.$left,i.$right,e),i}},t}(e);e.multiselect={defaults:{startUp:function(e,t){t.find("option").each(function(t,l){var o=e.find('option[value="'+l.value+'"]');o.parent();o.remove()})},beforeMoveToRight:function(e,t,l){return!0},afterMoveToRight:function(e,t,l){},beforeMoveToLeft:function(e,t,l){return!0},afterMoveToLeft:function(e,t,l){},sort:function(e,t){return"NA"==e.innerHTML?1:"NA"==t.innerHTML?-1:e.innerHTML>t.innerHTML?1:-1}}},e.fn.multiselect=function(l){return this.each(function(){var o=e(this),i=o.data(),n=e.extend({},e.multiselect.defaults,i,l);return new t(o,n)})},e.fn.removeIfEmpty=function(){return this.children().length||this.remove(),this},e.fn.mfilter=function(e){for(var t=document.createDocumentFragment(),l=this.get(0),o=l.querySelectorAll("option"),i=e.toLowerCase(),n=0;n<o.length;n++)if(0===i.length||o[n].innerHTML.toLowerCase().indexOf(i)>-1)t.appendChild(o[n]);else{var r=document.createElement("span");r.appendChild(o[n]),t.appendChild(r)}this.empty(),l.appendChild(t.cloneNode(!0))},e.fn.mSort=function(e){var t=this.get(0),l=Array.prototype.slice.call(t.querySelectorAll("option"),0);l.sort(e);for(var o=document.createDocumentFragment(),i=0;i<l.length;i++)o.appendChild(l[i]);return t.appendChild(o.cloneNode(!0)),this}});